Используется <strong>conntrack</strong> - компонент netfilter, обеспечивающий отслеживание состояния соединений и классификацию 
пакетов с точки зрения принадлежности к соединениям, что позволяет netfilter осуществлять полноценную stateful-фильтрацию трафика. 
Как и netfilter, система conntrack является частью ядра Linux. <br><br>

Задачи:<br>
<ul>Отслеживание состояний отдельных соединений с тем, чтобы классифицировать каждый пакет либо как относящийся к 
уже установленному соединению, либо как открывающий новое соединение. При этом понятие «состояние соединения» искусственно вводится 
для протоколов, в которых оно изначально отсутствует (UDP, ICMP). При работе же с протоколами, 
поддерживающими состояния (например, TCP), conntrack активно использует эту возможность, тесно взаимодействуя с базовой сетевой подсистемой ядра Linux.</ul>
<ul>Отслеживание связанных соединений, например, ICMP-ответов на TCP и UDP-пакеты. Более сложный вариант — протоколы, использующие несколько 
соединений в одной сессии, например, FTP. Для правильной обработки таких протоколов conntrack использует специальные модули (conntrack helpers), 
которые анализируют трафик и «выхватывают» информацию протокола о новых соединениях (например, порт, на который оно будет открыто), 
что позволяет обеспечить их корректную фильтрацию, маршрутизацию, шейпинг и пропускание через NAT.</ul>

<br> Для взаимодействия с системой conntrack из userspace разработан комплект conntrack-tools, содержащий две утилиты:
<ul><strong>conntrack</strong> — инструмент, позволяющий системному администратору наблюдать таблицы состояний соединений и 
взаимодействовать с ними: очищать таблицы целиком, удалять отдельные записи, маркировать соединения вручную (аналог действия CONNMARK), 
устанавливать тайм-ауты соединений. Поддерживается фильтрация вывода (например, на основании адресов и/или портов источника и/или назначения), 
а также вывод в различных форматах, включая XML. Кроме того, данная утилита позволяет отслеживать в реальном времени 
события системы conntrack, например, открытие новых соединений или изменение состояния существующих.</ul>
<ul><strong>conntrackd</strong> — демон, обеспечивающий синхронизацию таблиц состояний с другими хостами, что в сочетании 
с возможностями демона keepalived позволяет создавать фаерволы на кластерах высокой доступности (High Availability) — при выходе 
из строя одного из хостов кластера его соединения будут «подхвачены» другими хостами кластера и корректно обработаны с учетом состояний. 
Также conntrackd можно использовать просто для удаленного сбора статистики по соединениям.</ul> 
